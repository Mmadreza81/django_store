{% extends 'base.html' %}
{% load static %}
{% block title %}
	addresses
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">مدیریت آدرس‌ها</h2>

    <!-- جدول لیست آدرس‌ها -->
    <table class="table table-striped">
        <thead class="table-dark">
            <tr>
                <th>آدرس</th>
                <th>کد پستی</th>
                <th>عملیات</th>
            </tr>
        </thead>
        <tbody>
            {% for addr in addresses %}
            <tr>
                <td>{{ addr.address }}</td>
                <td>{{ addr.postal_code }}</td>
                <td>
                    <button class="btn btn-sm btn-primary edit-btn"
                            data-id="{{ addr.id }}"
                            data-address="{{ addr.address }}"
                            data-postal="{{ addr.postal_code }}">
                        ویرایش
                    </button>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">آدرسی ثبت نشده است.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <hr>

    <!-- فرم اضافه / ویرایش آدرس -->
    <h4 id="form-title">اضافه کردن آدرس جدید</h4>
    <form method="post" id="address-form" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="edit_id" id="edit_id">

        <div class="mb-3">
            <label for="address" class="form-label">آدرس</label>
            <input type="text" class="form-control" id="address" name="address"
                   value="{{ form.address.value|default_if_none:'' }}">
        </div>

        <div class="mb-3">
            <label for="postal_code" class="form-label">کد پستی</label>
            <input type="text" class="form-control" id="postal_code" name="postal_code"
                   value="{{ form.postal_code.value|default_if_none:'' }}">
        </div>

        <button type="submit" class="btn btn-success" id="submit-btn">ذخیره</button>
        <button type="button" class="btn btn-secondary" id="cancel-btn" style="display:none;">انصراف</button>
    </form>
</div>

<!-- لود JS از static -->
<script src="{% static 'accounts/js/manage_addresses.js' %}"></script>

{% endblock %}